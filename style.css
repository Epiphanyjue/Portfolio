:root {
    --p4-yellow: #FFE600;
    --p4-black: #111111;
    --p4-white: #FFFFFF;
    --p4-red: #E60033;
    --p4-blue: #0044CC;
    --p4-green: #009944;
    --font-main: 'Noto Sans SC', sans-serif;
    --font-tech: 'Chakra Petch', sans-serif;
    --nav-height: 70px;
    
    --current-theme-color: var(--p4-yellow);
    --current-theme-bg: var(--p4-black);
    
    --current-date-color: var(--p4-yellow); 
    --current-date-text: var(--p4-black);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    scroll-behavior: smooth;
}

body {
    background-color: var(--p4-yellow);
    color: var(--p4-black);
    font-family: var(--font-main);
    overflow-x: hidden;
    padding-top: 0;
    cursor: crosshair;
}

/* 统一鼠标样式 */
a:hover, .sub-capsule:hover, .work-card:hover, .category-item:hover, .date-widget:hover, .scroll-btn:hover, .contact-item:hover, #p4-enter-btn:hover {
    cursor: url('data:image/svg+xml;utf8,<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="0" y="0" width="24" height="24" fill="%23E60033" opacity="0.5"/><path d="M12 0L24 12L12 24L0 12L12 0Z" fill="%23FFE600"/></svg>') 12 12, pointer;
}

/* --- 噪点、扫描线与 CRT 增强 --- */
.noise-texture {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 9999; opacity: 0.12; 
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
}

.scanlines {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.1));
    background-size: 100% 4px; z-index: 9998; pointer-events: none;
    animation: scanline-scroll 0.5s linear infinite;
}
@keyframes scanline-scroll { 0% { background-position: 0 0; } 100% { background-position: 0 4px; } }

.crt-vignette {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    z-index: 1001; pointer-events: none;
    background: radial-gradient(circle, rgba(0,0,0,0) 75%, rgba(0,0,0,0.15) 100%);
    box-shadow: inset 0 0 60px rgba(0,0,0,0.2);
}

.tv-frame {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 1000;
    border: 15px solid var(--p4-black); border-top-width: 0; 
    border-radius: 20px;
    box-shadow: inset 0 0 50px rgba(0,0,0,0.2);
}

/* [NEW] 子页面专用边框样式：加宽底部以遮盖背景 */
.tv-frame.sub-page-frame {
    border-bottom-width: 50px; /* 增加到底部宽度，形成遮罩 */
}

/* --- 导航栏 --- */
.p4-top-nav {
    position: fixed; top: 0; left: 0; width: 100%; height: var(--nav-height);
    background: var(--p4-black); display: flex; justify-content: space-between;
    align-items: center; padding: 0 2rem; z-index: 1100;
    transform: skewY(-0.5deg); transform-origin: top left;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    
    background-image: linear-gradient(to right, 
        var(--p4-yellow) 0%, var(--p4-yellow) 70%,
        var(--p4-red) 70%, var(--p4-red) 80%,
        var(--p4-green) 80%, var(--p4-green) 90%,
        var(--p4-blue) 90%, var(--p4-blue) 100%
    );
    background-size: 100% 6px;
    background-repeat: no-repeat;
    background-position: bottom;
    padding-bottom: 6px;
    border-bottom: none;
}

.nav-brand {
    font-family: var(--font-tech); font-weight: 900; font-size: 1.5rem;
    color: var(--p4-yellow); transform: skewY(0.5deg); letter-spacing: 1px;
    transition: opacity 0.3s;
}

.nav-links { display: flex; gap: 1rem; transform: skewY(0.5deg); transition: all 0.4s ease; }

.nav-item {
    text-decoration: none; font-family: var(--font-tech); font-weight: 700;
    font-size: 1.1rem; color: var(--p4-yellow); padding: 8px 15px;
    position: relative; transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transform: skewX(-15deg); display: flex; align-items: baseline; gap: 5px;
}

.nav-item small { font-size: 0.8rem; opacity: 0.6; font-weight: normal; }

.nav-item:hover {
    background: var(--current-theme-color); color: var(--current-theme-bg);
    box-shadow: 5px 5px 0 var(--current-theme-bg); 
    transform: skewX(-15deg) translateY(-3px) scale(1.1);
    z-index: 10;
}

/* ==========================================================================
   Contact 按钮逻辑
   ========================================================================== */

/* 1. 基础样式 (顶部导航栏默认样式) */
.highlight-btn {
    width: auto;
    height: auto;
    padding: 6px 25px;
    margin-left: 15px; 
    
    border: 3px solid var(--p4-white);
    border-radius: 50px; 
    transform: skewX(-15deg); 
    
    background: transparent !important;
    color: var(--p4-yellow) !important;
    
    animation: none !important;
    box-shadow: none;
    
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    transition: all 0.2s ease;
    z-index: 20;
    overflow: hidden; 
}

/* 顶部模式 Hover */
.highlight-btn:hover {
    background: var(--current-date-color) !important;
    color: var(--current-date-text) !important;
    box-shadow: 0 0 10px var(--current-date-color);
    transform: skewX(-15deg) translateY(-3px); 
    
    width: auto !important;
    height: auto !important;
    border-radius: 50px !important;
    border-color: var(--p4-white) !important;
    padding: 6px 25px !important;
}

/* 内部文字样式 */
.btn-static {
    display: flex;
    align-items: baseline;
    justify-content: center;
    width: 100%;
    transition: all 0.3s ease-out;
}
.highlight-btn small {
    background: rgba(0,0,0,0.2);
    border-radius: 10px;
    padding: 0 6px;
    margin-left: 6px;
    font-size: 0.75rem;
}

.highlight-btn .btn-hover-effect {
    display: none !important;
}
.highlight-btn .btn-static {
    position: relative;
    opacity: 1 !important;
    transform: none !important;
}

/* [修复] 幽灵触控层 (Hitbox Ghost Layer) */
.highlight-btn::after {
    content: '';
    position: absolute;
    top: 50%; 
    left: 50%;
    transform: translate(-50%, -50%); 
    width: 120%;  
    height: 150%; 
    background: transparent; 
    z-index: -1; 
    pointer-events: auto; 
    display: block !important; 
}

/* 波浪动画层基础样式 */
.wave-ring {
    position: absolute;
    width: 100%; height: 100%;
    border-radius: 50%;
    background: transparent;
    border: 4px solid var(--current-date-color); 
    opacity: 0;
    z-index: 1;
    box-sizing: border-box;
    pointer-events: none;
}
.center-icon {
    font-family: var(--font-tech); font-weight: 900; font-size: 1rem;
    color: var(--current-date-text); z-index: 5;
    text-shadow: 0 0 5px var(--p4-white);
}

/* ==========================================================================
   2. 侧边栏模式 (Sidebar Mode)
   ========================================================================== */

.p4-top-nav.sidebar-mode .highlight-btn {
    width: 160px;
    height: 48px;
    padding: 0;
    margin-left: 0;
    margin-top: 3rem; 
    
    background: var(--current-date-color) !important;
    color: var(--current-date-text) !important;
    
    transform: rotate(-4deg);
    border-radius: 50px;
    overflow: visible; 
    
    animation: p4-signal-jolt 4s ease-in-out infinite !important;
    box-shadow: 4px 4px 0 rgba(0,0,0,0.5), 0 0 10px var(--current-date-color);
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.p4-top-nav.sidebar-mode .highlight-btn:hover {
    width: 90px !important;
    height: 90px !important;
    border-radius: 50% !important;
    transform: rotate(0deg) scale(1.1) !important;
    animation: none !important; 
    box-shadow: 0 0 40px var(--current-date-color), inset 0 0 25px var(--p4-white) !important;
    border-color: var(--p4-white) !important;
}

.p4-top-nav.sidebar-mode .highlight-btn .btn-hover-effect {
    display: flex !important; 
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    align-items: center; justify-content: center;
    opacity: 0; transition: all 0.3s ease-in;
}

.p4-top-nav.sidebar-mode .highlight-btn:hover .btn-hover-effect {
    opacity: 1;
}

.p4-top-nav.sidebar-mode .highlight-btn:hover .btn-static {
    opacity: 0 !important;
    transform: scale(0.5) !important;
    position: absolute; 
}

.p4-top-nav.sidebar-mode .highlight-btn:hover .wave-ring {
    animation: p4-wave-breath 2s cubic-bezier(0.165, 0.84, 0.44, 1) infinite;
}
.p4-top-nav.sidebar-mode .highlight-btn:hover .wave-1 { animation-delay: 0s; border-color: var(--p4-white); }
.p4-top-nav.sidebar-mode .highlight-btn:hover .wave-2 { animation-delay: 0.4s; border-width: 5px; }
.p4-top-nav.sidebar-mode .highlight-btn:hover .wave-3 { animation-delay: 0.8s; border-width: 3px; opacity: 0.6; }

.p4-top-nav.sidebar-mode .highlight-btn::after {
    width: 300px; 
    height: 150px; 
    transform: translate(-50%, -50%) rotate(-4deg); 
}

/* ==========================================================================
   3. [新增] 底部 CTA (Call To Action) 强力模式
   当用户滑到底部时，覆盖侧边栏样式，加强动画
   ========================================================================== */
.p4-top-nav.sidebar-mode .highlight-btn.bottom-cta {
    transform: rotate(-4deg) scale(1.2) !important;
    box-shadow: 0 0 20px var(--current-date-color), 0 0 40px var(--current-date-color) !important;
    border-color: #fff !important;
    animation: p4-hyper-jolt 0.8s ease-in-out infinite !important; /* 更快的频率 */
    z-index: 2000;
}

/* 底部 Hover 依然保持变圆的逻辑，但更亮 */
.p4-top-nav.sidebar-mode .highlight-btn.bottom-cta:hover {
    transform: rotate(0deg) scale(1.3) !important;
    box-shadow: 0 0 60px var(--current-date-color), inset 0 0 30px #fff !important;
    animation: none !important;
}

@keyframes p4-signal-jolt {
    0%, 100% { transform: rotate(-4deg) translateY(0) scale(1); border-color: var(--p4-white); }
    40% { transform: rotate(-3deg) translateY(-4px) scale(1.02); }
    86% { transform: rotate(-4deg) skewX(-10deg) translate(-2px, 2px); border-color: var(--current-date-color); }
    88% { transform: rotate(-4deg) skewX(5deg) translate(2px, -2px); border-color: var(--p4-white); }
    90% { transform: rotate(-4deg) scale(0.98); }
}

@keyframes p4-wave-breath {
    0% { transform: scale(0.8); opacity: 1; border-width: 6px; }
    100% { transform: scale(3.5); opacity: 0; border-width: 0px; }
}

/* [新增] 强力心跳动画 */
@keyframes p4-hyper-jolt {
    0%, 100% { transform: rotate(-4deg) scale(1.2); }
    50% { transform: rotate(-4deg) scale(1.3); } 
}


/* --- 日期组件样式 (已恢复静态) --- */
.date-widget {
    position: absolute; top: 80px; right: 2rem;
    font-family: var(--font-tech); font-weight: 900;
    font-size: 2.2rem;
    padding: 15px 35px;
    transform: skew(-10deg);
    border: 2px solid var(--p4-white);
    box-shadow: 10px 10px 0 rgba(0,0,0,0.5);
    z-index: 1050; cursor: pointer;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    user-select: none; 
    color: var(--current-date-text); 
    background: var(--current-date-color);
    animation: none;
}
.date-widget:hover {
    transform: skew(-10deg) translate(-4px, -4px);
    box-shadow: 14px 14px 0 rgba(0,0,0,0.6); border-color: #fff;
}

/* --- 侧边栏模式 --- */
.p4-top-nav.sidebar-mode {
    top: 50%; bottom: auto; right: 3rem; left: auto; width: auto; height: auto;
    background: transparent; border-bottom: none; box-shadow: none;
    transform: translateY(-50%); flex-direction: column; align-items: flex-end; gap: 0;
}
.p4-top-nav.sidebar-mode .nav-brand { display: none; }
.p4-top-nav.sidebar-mode .date-widget { position: relative; top: auto; right: auto; margin-bottom: 2rem; order: 1; }
.p4-top-nav.sidebar-mode .nav-links { flex-direction: column; transform: skewY(0); gap: 1.5rem; order: 2; }
.p4-top-nav.sidebar-mode .nav-item {
    background: var(--p4-black); color: var(--p4-yellow);
    border: 3px solid var(--p4-white); padding: 12px 25px;
    transform: skewX(-10deg); box-shadow: 8px 8px 0 rgba(0,0,0,0.3);
}

/* 侧边栏模式下：激活状态颜色联动 */
.p4-top-nav.sidebar-mode .nav-item:hover {
    background: var(--current-theme-color); color: var(--current-theme-bg);
    border-color: var(--current-theme-bg); box-shadow: 10px 10px 0 var(--current-theme-bg);
    transform: skewX(-10deg) translateX(-5px);
}

/* 移动端适配 */
@media (max-width: 768px) {
    .p4-top-nav { padding: 0 1rem; }
    .nav-brand { font-size: 1.2rem; }
    .nav-item { font-size: 0.9rem; padding: 5px 10px; }
    .nav-item small { display: none; }
    .p4-top-nav.sidebar-mode {
        position: fixed; top: 0; left: 0; right: auto; bottom: auto;
        width: 100%; height: var(--nav-height);
        background: var(--p4-black); 
        border-bottom: none; 
        transform: skewY(-0.5deg); flex-direction: row; align-items: center;
    }
    .p4-top-nav.sidebar-mode .nav-brand { display: block; }
    .p4-top-nav.sidebar-mode .nav-links { flex-direction: row; transform: skewY(0.5deg); gap: 1rem; order: unset; }
    .p4-top-nav.sidebar-mode .date-widget { 
        position: absolute; top: 80px; right: 1rem; margin-bottom: 0; order: unset;
        font-size: 1.8rem; padding: 12px 30px;
    }
    .p4-top-nav.sidebar-mode .nav-item { background: transparent; border: none; box-shadow: none; padding: 8px 15px; transform: skewX(-15deg); color: var(--p4-yellow); }
    
    .highlight-btn, .p4-top-nav.sidebar-mode .highlight-btn {
        border-radius: 0; transform: skewX(-15deg); padding: 8px 15px; margin-left: 0; margin-top: 0;
        background: transparent !important; color: var(--p4-yellow) !important; border: none;
        width: auto !important; height: auto !important; animation: none !important;
    }
    .p4-top-nav.sidebar-mode .highlight-btn:hover {
        border-radius: 0 !important; width: auto !important; height: auto !important; transform: skewX(-15deg) scale(1.1) !important;
    }
}

/* --- 全屏板块基础样式 --- */
.full-screen-section {
    min-height: 100vh; width: 100%;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    position: relative; padding: calc(var(--nav-height) + 2rem) 2rem 4rem 2rem; overflow: hidden;
}

/* Profile 区域的黄色波点背景 */
.bg-yellow { 
    background-color: var(--p4-yellow); 
    background-image: 
        radial-gradient(var(--p4-black) 15%, transparent 16%),
        repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0,0,0,0.05) 10px, rgba(0,0,0,0.05) 20px);
    background-size: 20px 20px, 100% 100%;
    background-position: 0 0, 0 0;
}

/* Works 区域的白色背景 */
.bg-white { 
    background-color: #F0F0F0; color: var(--p4-black);
    background-image: radial-gradient(#ccc 1px, transparent 1px); background-size: 20px 20px;
}
.section-content-wrapper { max-width: 1400px; width: 100%; z-index: 10; }

/* 几何体和 Landing */
.floating-shape { position: absolute; z-index: -1; opacity: 0.15; pointer-events: none; }
@keyframes float-slow-bob { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-40px) rotate(15deg); } }
@keyframes float-drift-horiz { 0% { transform: translateX(0) rotate(0deg) scale(1); } 50% { transform: translateX(60px) rotate(90deg) scale(1.1); } 100% { transform: translateX(0) rotate(180deg) scale(1); } }
.shape-p4-1 { width: 120px; height: 120px; top: 15%; left: 8%; background: var(--p4-black); clip-path: polygon(50% 0%, 0% 100%, 100% 100%); animation: float-slow-bob 12s ease-in-out infinite; }
.shape-p4-2 { width: 100px; height: 100px; bottom: 25%; right: 12%; background: var(--p4-red); clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%); animation: float-drift-horiz 18s ease-in-out infinite reverse; }

.landing-container { display: grid; grid-template-columns: 1.2fr 1fr; gap: 4rem; max-width: 1400px; width: 90%; align-items: center; }
.hero-text-group { position: relative; }
.top-tag { font-family: var(--font-tech); margin-bottom: 1rem; transform: skew(-10deg); display: inline-block; }
.portfolio-title-wrapper { position: relative; height: auto; margin-bottom: 2rem; }
.portfolio-title-wrapper h1 { 
    font-family: var(--font-tech); 
    font-size: clamp(3.5rem, 8vw, 8rem); 
    line-height: 0.9; 
    font-weight: 900; 
    margin: 0; 
    text-transform: uppercase; 
    transform: skew(-5deg); 
    position: relative; 
    letter-spacing: -5px; 
}

.main-glitch { 
    color: var(--p4-black); z-index: 3; 
    text-shadow: 4px 4px 0 var(--p4-yellow), 8px 8px 0 var(--p4-black);
    paint-order: stroke fill; 
}
.shadow-layer { 
    position: absolute; top: 10px; left: 10px; 
    color: var(--p4-red); z-index: 2; opacity: 0.8; 
    mix-blend-mode: multiply;
    animation: glitch-anim-smooth-1 4s linear infinite; 
}
.outline-layer { 
    position: absolute; top: 15px; left: 15px; 
    color: transparent; -webkit-text-stroke: 2px var(--p4-blue); z-index: 1; opacity: 0.5; 
    animation: glitch-anim-smooth-2 5s linear infinite reverse; 
}

@keyframes glitch-anim-smooth-1 { 
    0%, 100% { clip-path: inset(0 0 0 0); transform: skew(-5deg) translate(0); opacity: 0.8; } 
    10% { clip-path: inset(10% 0 85% 0); transform: skew(-5deg) translate(-2px, 1px); } 
    30% { clip-path: inset(40% 0 55% 0); transform: skew(-5deg) translate(2px, -1px); } 
    50% { clip-path: inset(65% 0 30% 0); transform: skew(-5deg) translate(-2px, 1px); } 
    70% { clip-path: inset(85% 0 10% 0); transform: skew(-5deg) translate(2px, -1px); } 
    80% { clip-path: inset(50% 0 50% 0); transform: skew(-5deg) translate(0, 0); opacity: 0.3; } 
}

@keyframes glitch-anim-smooth-2 { 
    0%, 100% { clip-path: inset(0 0 0 0); transform: skew(-5deg) translate(0); opacity: 0.5; } 
    15% { clip-path: inset(15% 0 80% 0); transform: skew(-5deg) translate(3px, -1px); } 
    35% { clip-path: inset(45% 0 50% 0); transform: skew(-5deg) translate(-3px, 1px); } 
    55% { clip-path: inset(70% 0 25% 0); transform: skew(-5deg) translate(3px, -1px); } 
    75% { clip-path: inset(90% 0 5% 0); transform: skew(-5deg) translate(-3px, 1px); } 
    85% { clip-path: inset(20% 0 75% 0); transform: skew(-5deg) translate(1px, 1px); opacity: 0.2;} 
}

/* ==========================================================================
   [Updated] START GAME Button (.sub-capsule)
   ========================================================================== */
.sub-capsule { 
    display: inline-flex; align-items: center; 
    background: var(--current-date-color); 
    color: var(--current-date-text); 
    padding: 1rem 2rem; font-size: 1.5rem; font-weight: bold; transform: skew(-10deg); 
    border: 3px solid var(--p4-white); box-shadow: 10px 10px 0 var(--p4-black); 
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
    cursor: pointer; 
    position: relative;
    overflow: hidden;
    text-decoration: none; /* 确保链接下划线消失 */
}

/* Hover: 剧烈抖动 + 颜色反转 + 故障错位 */
.sub-capsule:hover { 
    transform: skew(-10deg) translate(-5px, -5px) scale(1.05); 
    box-shadow: 15px 15px 0 var(--p4-red), -5px -5px 0 var(--p4-blue);
    background: var(--p4-black);
    color: var(--p4-yellow);
    animation: btn-glitch-shake 0.3s cubic-bezier(.36,.07,.19,.97) infinite;
}

/* 简单的抖动动画 Keyframes */
@keyframes btn-glitch-shake {
  0% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(1px, 1px); }
  10% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(-1px, -2px); }
  20% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(-3px, 0px); }
  30% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(3px, 2px); }
  40% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(1px, -1px); }
  50% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(-1px, 2px); }
  60% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(-3px, 1px); }
  70% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(3px, 1px); }
  80% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(-1px, -1px); }
  90% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(1px, 2px); }
  100% { transform: skew(-10deg) translate(-5px, -5px) scale(1.05) translate(1px, -2px); }
}

/* --- [修改] 条形码样式：增加动画引用 --- */
.barcode-deco { 
    height: 40px; 
    width: 200px; 
    /* 保持原有的纹理 */
    background: repeating-linear-gradient(90deg, #000, #000 2px, transparent 2px, transparent 5px); 
    margin-bottom: 2rem; 
    opacity: 0.7;
    /* 新增：P4 风格扫描动画，使用 step-end 制造数码顿挫感 */
    animation: p4-barcode-scan 4s steps(5) infinite;
    /* 硬件加速，防止动画模糊 */
    will-change: opacity, background-position;
}

/* --- [新增] 条形码动态效果 Keyframes --- */
@keyframes p4-barcode-scan {
    0%, 100% { opacity: 0.7; background-position: 0 0; }
    50% { opacity: 0.5; }
    52% { opacity: 0.8; background-position: 4px 0; } /* 瞬间的数据跳动 */
    54% { opacity: 0.7; background-position: 0 0; }
    90% { transform: scaleY(1); }
    92% { transform: scaleY(0.95); } /* 极其微小的垂直压缩故障 */
    94% { transform: scaleY(1); }
}
.tagline { margin-top: 1.5rem; font-weight: bold; background: var(--p4-black); color: var(--p4-white); display: inline-block; padding: 5px 10px; transform: rotate(1deg); }
.visual-stack { position: relative; height: 500px; display: flex; justify-content: center; align-items: center; }
.circle-deco { position: absolute; width: 400px; height: 400px; border: 2px dashed var(--p4-black); border-radius: 50%; animation: rotate-deco 20s linear infinite reverse; }
@keyframes rotate-deco { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
.tv-box { position: absolute; background: var(--p4-black); border: 4px solid var(--p4-white); display: flex; justify-content: center; align-items: center; color: var(--p4-yellow); font-family: var(--font-tech); font-weight: bold; box-shadow: 10px 10px 0 rgba(0,0,0,0.2); transition: all 0.3s; cursor: default; }
.tv-box:hover { background: var(--p4-yellow); color: var(--p4-black); border-color: var(--p4-black); z-index: 100 !important; transform: scale(1.1) !important; }
.tv-1 { width: 300px; height: 200px; z-index: 3; transform: rotate(-5deg); font-size: 2rem; }
.tv-2 { width: 200px; height: 150px; top: 50px; right: 20px; z-index: 2; transform: rotate(10deg); background: var(--p4-blue); color: white; }
.tv-3 { width: 220px; height: 180px; bottom: 40px; left: 0; z-index: 2; transform: rotate(-15deg); background: var(--p4-red); color: white; }
.tv-static { width: 100%; height: 100%; opacity: 0.1; background: repeating-radial-gradient(circle, #fff, #000 2px); position: absolute; top:0; left:0; pointer-events: none; }
.marquee-strip { background: var(--p4-black); color: var(--p4-yellow); padding: 15px 0; font-family: var(--font-tech); font-weight: 700; overflow: hidden; white-space: nowrap; border-top: 4px solid var(--p4-white); border-bottom: 4px solid var(--p4-white); transform: rotate(-2deg); position: relative; z-index: 20; box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
.marquee-content { display: inline-block; animation: marquee 20s linear infinite; font-size: 2.5rem; letter-spacing: 2px; line-height: 1; }
@keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

/* --- Profile Container & Deco --- */
.profile-container { 
    display: grid; grid-template-columns: 350px 1fr; gap: 3rem; 
    background: var(--p4-white); 
    padding: 3rem; 
    box-shadow: 20px 20px 0 rgba(0,0,0,0.8); 
    transform: rotate(-1deg); max-width: 1000px; margin: 0 auto;
    position: relative;
    background-image: url('data:image/svg+xml;utf8,<svg width="4" height="4" viewBox="0 0 4 4" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" fill="%23eeeeee"/></svg>');
    border: 4px solid var(--p4-black);
    outline: 4px solid var(--p4-yellow);
    outline-offset: -10px;
}

.deco-glasses {
    position: absolute; top: -40px; right: -40px;
    width: 200px; height: 80px; opacity: 0.2; transform: rotate(15deg);
    pointer-events: none; z-index: 0;
    display: flex; gap: 10px; justify-content: center; align-items: center;
}
.glass-left, .glass-right { width: 60px; height: 40px; border: 8px solid var(--p4-black); border-radius: 5px 5px 20px 20px; }
.glass-bridge { width: 20px; height: 8px; background: var(--p4-black); }

.logo-box { background: var(--p4-black); color: var(--p4-yellow); height: 250px; display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: 900; font-family: var(--font-tech); border: 3px dashed var(--p4-yellow); z-index: 1; }
.intro-content { z-index: 1; }
.intro-header { background: var(--p4-yellow); display: inline-block; font-family: var(--font-tech); font-size: 3rem; font-weight: 900; padding: 0 10px; transform: skew(-10deg); margin-bottom: 1.5rem; }

.intro-content p {
    font-family: 'Noto Sans SC', sans-serif; font-weight: 900; 
    font-size: 1.35rem; line-height: 1.6; margin-bottom: 1rem;
    transform: skewX(-5deg); letter-spacing: 0.5px;
    color: var(--p4-black); text-shadow: 1px 1px 0 rgba(0,0,0,0.1);
}
.intro-content p strong { color: var(--p4-red); font-size: 1.5rem; }

.section-big-title { font-family: var(--font-tech); font-size: 3rem; margin-bottom: 2rem; text-transform: uppercase; display: flex; align-items: center; gap: 10px; }
.section-big-title::before { content: '▶'; color: var(--p4-black); }

/* HIGHLIGHTS 区域 */
#highlights {
    background-color: #111111;
    color: var(--p4-white);
    background-image: 
        linear-gradient(rgba(255, 230, 0, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 230, 0, 0.1) 1px, transparent 1px);
    background-size: 40px 40px;
    background-position: center top;
    box-shadow: inset 0 20px 50px rgba(0,0,0,0.8);
    position: relative;
    overflow: hidden;
    margin-top: -80px; 
    padding-top: 160px; 
    z-index: 5;
}

#highlights::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background: radial-gradient(circle at 50% 50%, transparent 0%, #000 85%);
    pointer-events: none;
    z-index: 1;
}

#highlights .section-big-title {
    color: var(--p4-yellow);
    text-shadow: 
        3px 3px 0 var(--p4-red),
        -1px -1px 0 var(--p4-blue);
    position: relative;
    z-index: 2;
    padding-left: 4rem !important;
    font-style: italic;
}

#highlights .section-big-title::after {
    content: '';
    display: inline-block;
    width: 20px; height: 40px;
    background: var(--p4-white);
    margin-left: 15px;
    animation: blink-cursor 1s step-end infinite;
}
@keyframes blink-cursor { 50% { opacity: 0; } }

/* --- 修改 .film-strip-wrapper --- */
/* 作用：作为遮罩窗口，精确控制显示宽度，确保只显示整数个卡片 */

.film-strip-wrapper {
    /* 计算公式：(380px * 4) + (40px * 3) = 1520 + 120 = 1640px */
    width: 1640px; 
    max-width: 95vw; /* 防止在极端小屏幕溢出 */
    
    margin: 0 auto; /* 居中显示 */
    /* [修复] 将 padding 移至内部 container，防止 hover 放大时被裁切 */
    padding: 0; 
    position: relative;
    overflow: hidden; /* 隐藏超出的卡片，消除"半张"现象 */
    
    /* 保留原有的装饰线和发光 */
    background-color: transparent; 
    border-top: 2px solid var(--p4-yellow);
    border-bottom: 2px solid var(--p4-yellow);
    box-shadow: 0 0 30px rgba(255, 230, 0, 0.1);
    z-index: 10;
    
    /* 重置之前的全屏强制拉伸代码 */
    left: auto; right: auto; 
}

/* --- 修改 .film-strip-container --- */
/* 作用：作为滚动容器，处理内容的实际滑动 */
.film-strip-container { 
    width: 100%; 
    overflow-x: auto; /* 允许横向滚动 */
    /* [修复] 增加内边距，为卡片放大预留空间 (上下60px防止垂直裁切，左右40px防止边缘裁切) */
    padding: 60px 40px; 
    cursor: grab; 
    display: flex; 
    justify-content: flex-start; /* 必须左对齐，才能正确计算滚动距离 */
    z-index: 5; 
    position: relative;
    scroll-behavior: smooth; /* CSS原生平滑滚动 */
    
    /* 隐藏默认滚动条，保持美观 */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none;  /* IE */
}
.film-strip-container::-webkit-scrollbar { display: none; /* Chrome/Safari */ }

/* .film-track 保持不变，但建议检查一下 gap 是否确实为 40px */
.film-track { display: flex; gap: 40px; will-change: transform; }

/* --- [关键] 响应式断点控制 --- */
/* 根据屏幕宽度自动缩减显示的卡片数量，始终保持整数倍 */

/* 当屏幕小于 1700px 时，显示 3 个 (380*3 + 40*2 = 1220px) */
@media (max-width: 1700px) {
    .film-strip-wrapper { width: 1220px; }
}

/* 当屏幕小于 1280px 时，显示 2 个 (380*2 + 40 = 800px) */
@media (max-width: 1280px) {
    .film-strip-wrapper { width: 800px; }
}

/* 当屏幕小于 860px 时，显示 1 个 (380px) */
@media (max-width: 860px) {
    .film-strip-wrapper { width: 380px; }
}

/* ==========================================================================
   [Updated] Work Card (Unified Skew & Reset on Hover)
   ========================================================================== */
/* --- [修改] Work Card：明确层级关系 --- */
.work-card {
    width: 380px; height: 320px; flex-shrink: 0;
    background: #e0e0e0;
    border: 6px solid var(--p4-white); 
    position: relative;
    transform: skewX(-5deg);
    transition: transform 0.3s ease, border-color 0.3s, box-shadow 0.3s; 
    display: flex; flex-direction: column;
    box-shadow: 10px 10px 0 rgba(255, 255, 255, 0.2);
    user-select: none;
    
    /* [关键修复] 设置默认层级为 1，确保未激活时层级较低 */
    z-index: 1; 
}

.work-card.center-focus {
    /* 焦点状态：回正 + 放大 */
    transform: skewX(0deg) scale(1.1);
    border-color: var(--p4-yellow);
    box-shadow: 0 0 20px var(--p4-yellow), 15px 15px 0 var(--p4-red);
    z-index: 20;
}

.work-card:not(.center-focus) {
    opacity: 0.6;
    transform: skewX(-5deg) scale(0.95);
    filter: grayscale(80%);
}

/* --- [修改] Work Card Hover：极大提升层级 --- */
.work-card:hover { 
    opacity: 1;
    transform: skewX(0deg) scale(1.15) translateY(-5px); 
    filter: grayscale(0%);
    
    /* [关键修复] 提升层级至 100，确保放大时绝对覆盖旁边的卡片 */
    z-index: 100; 
}

.work-img { height: 70%; background: #333; display: flex; align-items: center; justify-content: center; overflow: hidden; border-bottom: 4px solid var(--p4-black); }
.work-img img { width: 100%; height: 100%; object-fit: cover; pointer-events: none; }
/* --- 补充修改 .work-info (防止卡片内部遮挡) --- */
.work-info { 
    padding: 15px; 
    background: var(--p4-white); 
    flex-grow: 1; 
    position: relative;
    /* [新增] 确保文字层永远位于图片层(默认z-index:0)之上 */
    z-index: 10; 
}
.work-info h4 { font-size: 1.6rem; color: var(--p4-black); font-weight: 900; margin-bottom: 5px; text-transform: uppercase; }
.work-info small { background: var(--p4-black); color: var(--p4-yellow); padding: 2px 5px; font-weight: bold; }

/* ==========================================================================
   [UPDATED] Scroll Controls (带禁用状态)
   ========================================================================== */
.scroll-controls { display: flex; justify-content: center; align-items: center; gap: 20px; margin-top: 2rem; position: relative; z-index: 10;}

.scroll-btn {
    width: 60px; height: 40px; 
    background: var(--p4-black);
    color: var(--p4-yellow);
    border: 3px solid var(--p4-yellow);
    font-size: 1.5rem; font-weight: bold; display: flex; align-items: center; justify-content: center;
    cursor: pointer; transform: skew(-15deg); 
    box-shadow: 5px 5px 0 rgba(255,255,255,0.2);
    transition: all 0.2s ease;
}

.scroll-btn:not(.disabled):hover { 
    background: var(--p4-yellow); 
    color: var(--p4-black); 
    box-shadow: 0 0 15px var(--p4-yellow);
    transform: skew(-15deg) translate(-2px, -2px); 
}

.scroll-btn:not(.disabled):active { 
    transform: skew(-15deg) translate(2px, 2px); 
    box-shadow: 2px 2px 0 rgba(255,255,255,0.2); 
}

/* [新增] 禁用状态样式 - 灰色/无法点击 */
.scroll-btn.disabled {
    border-color: #555555; /* 深灰色边框 */
    color: #555555;        /* 深灰色箭头 */
    box-shadow: none;      /* 移除阴影 */
    cursor: not-allowed;   /* 鼠标变成禁止符号 */
    opacity: 0.6;          /* 降低不透明度 */
    pointer-events: none;  /* 禁止鼠标交互，防止点击 */
}

.scroll-deco-line { width: 200px; height: 4px; background: var(--p4-white); opacity: 0.3; }

/* --- Final Section --- */
.top-decoration-bar { position: absolute; top: 0; left: 0; width: 100%; height: 20px; background: repeating-linear-gradient(45deg, #FFDD00, #FFDD00 20px, #111 20px, #111 40px); }
.cat-section-title { font-size: 4rem; margin-bottom: 4rem; text-align: center; text-transform: uppercase; font-family: var(--font-main); font-weight: 900; }
.grid-layout { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 3rem; max-width: 1400px; margin: 0 auto; }

/* ==========================================================================
   [Updated] Category Item (Unified Skew & Reset on Hover)
   ========================================================================== */
.category-item {
    border: 4px solid var(--p4-black);
    padding: 5rem 2rem 3rem 2rem;
    position: relative;
    /* 添加默认倾斜 */
    transform: skewX(-5deg);
    /* 修改 1：将 0.3s 改为 0.15s */
    transition: all 0.15s cubic-bezier(0.34, 1.56, 0.64, 1);
    background: var(--p4-yellow);
    box-shadow: 10px 10px 0 rgba(0,0,0,1);
    overflow: visible; 
    z-index: 1; 
}

.category-item::before {
    content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: repeating-linear-gradient(0deg, rgba(0,0,0,0.1), rgba(0,0,0,0.1) 2px, transparent 2px, transparent 4px);
    opacity: 0; pointer-events: none; 
    /* 修改 2：将 0.2s 改为 0.1s */
    transition: 0.1s;
    z-index: -1; 
}
.category-item:hover {
    /* Hover 状态：回正 + 位移 + 放大 */
    transform: skewX(0deg) translate(-12px, -12px) scale(1.02) !important;
    box-shadow: 20px 20px 0 var(--p4-red) !important;
    background-color: #fff !important;
    /* [确认] 这里设置了 Hover 时的字体颜色为黑色 */
    color: var(--p4-black) !important;
    border-width: 6px;
    z-index: 10;
}
.category-item:hover::before { opacity: 1; }

.cat-title {
    font-family: var(--font-tech);
    font-size: 4rem;
    color: var(--p4-red);
    position: absolute;
    top: -40px;
    right: 20px;
    background: #fff;
    padding: 0 15px;
    border: 4px solid var(--p4-black); 
    /* 修改 3：将 0.3s 改为 0.15s */
    transition: all 0.15s cubic-bezier(0.34, 1.56, 0.64, 1);
    z-index: 2;
    transform-origin: bottom right;
}
/* [修改] Hover 时标签的颜色和边框使用主题色变量 */
.category-item:hover .cat-title {
    background: var(--p4-black);
    color: var(--theme-color) !important; /* 使用主题色 */
    border-color: var(--theme-color); /* 使用主题色 */
    transform: translateY(-15px) skewX(-10deg) scale(1.1);
    box-shadow: 5px 5px 0 rgba(0,0,0,0.3);
}

.cat-footer {
    margin-top: 2rem;
    text-align: right;
    font-weight: bold;
    font-family: var(--font-tech);
    /* 修改 4：将 0.3s 改为 0.15s */
    transition: all 0.15s ease;
}
/* [修改] Hover 时底部按钮文字使用主题色变量 */
.category-item:hover .cat-footer {
    color: var(--theme-color); /* 使用主题色 */
    letter-spacing: 3px;
    transform: translateX(5px);
}

.p4-connector-strip { margin: 4rem auto 2rem; max-width: 800px; height: 40px; background: var(--p4-black); color: var(--p4-yellow); display: flex; align-items: center; justify-content: center; font-family: var(--font-tech); font-weight: bold; transform: skew(-10deg); border: 2px solid var(--p4-yellow); }

/* [已删除] .contact-insert-container 等样式 */

.p4-reveal { opacity: 0; transform: translateY(50px) skewX(-10deg); transition: all 0.8s cubic-bezier(0.19, 1, 0.22, 1); }
.p4-reveal.active { opacity: 1; transform: translateY(0) skewX(0); }
.delay-1 { transition-delay: 0.1s; } .delay-2 { transition-delay: 0.2s; } .delay-3 { transition-delay: 0.3s; }

/* --- CONTACT Overlay 样式 --- */
.contact-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000;
    pointer-events: none; opacity: 0;
    display: flex; justify-content: center; align-items: flex-start;
    padding-top: 100px;
    transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1);
}

.contact-overlay.active { pointer-events: auto; opacity: 1; }

.overlay-bg {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(17, 17, 17, 0.9); backdrop-filter: blur(5px); z-index: -1;
}

.contact-panel {
    width: 600px; max-width: 90%;
    background: var(--current-date-color); /* 跟随日期颜色 */
    color: var(--current-date-text);
    border: 5px solid var(--p4-white);
    transform: translateY(-50px) skewX(-5deg);
    padding: 3rem;
    box-shadow: 20px 20px 0 rgba(0,0,0,0.5);
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    background-image: linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.1) 75%, transparent 75%, transparent);
    background-size: 20px 20px;
}

.contact-overlay.active .contact-panel { transform: translateY(0) skewX(-5deg); }

.close-btn {
    position: absolute; top: -20px; right: -20px;
    background: var(--p4-black); color: var(--p4-white);
    border: 2px solid var(--p4-white);
    padding: 10px 20px; font-family: var(--font-tech); font-weight: bold; font-size: 1.2rem;
    cursor: pointer; transform: skewX(5deg);
    transition: 0.2s;
}
.close-btn:hover { background: var(--p4-red); transform: skewX(5deg) scale(1.1); }

.contact-title { font-family: var(--font-tech); font-size: 3rem; font-weight: 900; margin-bottom: 1rem; text-transform: uppercase; text-shadow: 4px 4px 0 rgba(0,0,0,0.2); }
.contact-deco-line { width: 100%; height: 5px; background: var(--current-date-text); margin-bottom: 2rem; }
.contact-content-grid { display: flex; flex-direction: column; gap: 1.5rem; }

.contact-item {
    background: rgba(255,255,255,0.9); color: var(--p4-black);
    padding: 1rem 1.5rem; font-family: var(--font-tech); font-size: 1.5rem;
    display: flex; justify-content: space-between; align-items: center;
    border: 2px solid var(--p4-black); transform: skewX(-5deg);
    transition: 0.2s;
}
.contact-item:hover { transform: skewX(-5deg) translateX(10px); box-shadow: 5px 5px 0 var(--p4-black); }

.contact-item .label { font-weight: bold; opacity: 0.6; font-size: 1rem; }
.contact-item .value { font-weight: 900; color: var(--p4-black); text-decoration: none; }
.contact-item .value:hover { color: var(--p4-red); }

.p4-mascot-deco {
    position: absolute; bottom: -30px; left: -30px;
    background: var(--p4-black); color: var(--p4-yellow);
    padding: 10px 20px; font-weight: bold; font-family: var(--font-main);
    transform: rotate(-5deg); border: 2px solid var(--p4-white);
}

@media (max-width: 900px) {
    .landing-container { grid-template-columns: 1fr; text-align: center; gap: 2rem; }
    .visual-stack { height: 300px; transform: scale(0.8); }
    .profile-container { grid-template-columns: 1fr; transform: rotate(0); width: 90%; }
    .portfolio-title-wrapper h1 { font-size: 3rem; }
    .film-strip-wrapper { width: 100vw; margin-left: -50vw; margin-right: -50vw; left: 50%; right: 50%; }
    /* .contact-card-p4-style { transform: skew(0) rotate(0); width: 90%; } [Deleted] */
    
    .contact-panel { width: 95%; padding: 2rem; transform: translateY(-20px) skewX(0); }
    .contact-overlay.active .contact-panel { transform: translateY(0) skewX(0); }
    .contact-item { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
}



/* 导航栏激活状态 (修正为动态颜色) */
.nav-item.active {
    background: var(--current-theme-color) !important;
    color: var(--current-theme-bg) !important;
    transform: skewX(-15deg) scale(1.1) !important;
    box-shadow: 5px 5px 0 var(--current-theme-bg) !important;
    z-index: 100;
    font-weight: 900;
}
/* =========================================
   [NEW] 底部自动激活模式 (Auto Active Mode)
   ========================================= */

/* 1. 基础状态：当 JS 添加 auto-active 类时 (用户滑到底部) */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active {
    /* 强制变圆、变大 */
    width: 90px !important;
    height: 90px !important;
    border-radius: 50% !important;
    transform: rotate(0deg) scale(1.1) !important;
    
    /* 移除侧边栏默认的抖动动画 */
    animation: none !important;
    
    /* 应用高亮样式 */
    background: var(--current-date-color) !important;
    color: var(--current-date-text) !important;
    box-shadow: 0 0 40px var(--current-date-color), inset 0 0 25px var(--p4-white) !important;
    border-color: var(--p4-white) !important;
    
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* 隐藏原本的文字层 */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active .btn-static {
    opacity: 0 !important;
    transform: scale(0.5) !important;
    position: absolute; 
}

/* 强制显示波浪层 */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active .btn-hover-effect {
    display: flex !important;
    opacity: 1 !important;
}

/* 激活波浪动画 (默认慢速呼吸) */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active .wave-ring {
    animation: p4-wave-breath 2s cubic-bezier(0.165, 0.84, 0.44, 1) infinite !important;
}

/* 针对波浪的不同延迟 */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active .wave-1 { animation-delay: 0s; border-color: var(--p4-white); }
.p4-top-nav.sidebar-mode .highlight-btn.auto-active .wave-2 { animation-delay: 0.4s; border-width: 5px; }
.p4-top-nav.sidebar-mode .highlight-btn.auto-active .wave-3 { animation-delay: 0.8s; border-width: 3px; opacity: 0.6; }

/* -----------------------------------------------------------------------
   [新增] Auto Active 状态下的 Hover 增强效果 (应你要求添加的部分)
   ----------------------------------------------------------------------- */

/* A. 容器本身：颜色突变 + 亮度过载 */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active:hover {
    /* 颜色反转：背景变白，边框变红 (P4 风格的高对比警告色) */
    background: var(--p4-white) !important;
    border-color: var(--p4-yellow) !important;
    
    /* 亮度显著提高：叠加多重白色光晕 */
    box-shadow: 
        0 0 60px var(--p4-white), 
        0 0 30px var(--p4-yellow),
        inset 0 0 20px rgba(255,255,255,1) !important;
    
    /* 视觉反馈：进一步放大 */
    transform: rotate(0deg) scale(1.25) !important;
    filter: brightness(1.2) contrast(1.2);
    z-index: 3000;
}

/* B. 内部中心图标：变色 */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active:hover .center-icon {
    color: var(--p4-red) !important;
    text-shadow: 0 0 5px var(--p4-red);
}

/* C. 呼吸灯频率：极速加快 (Overdrive Mode) */
.p4-top-nav.sidebar-mode .highlight-btn.auto-active:hover .wave-ring {
    /* 频率：从 2s 加速到 0.5s */
    animation-duration: 0.5s !important;
    
    /* 波纹颜色变为红色，增加紧迫感 */
    border-color: var(--p4-yellow) !important;
    border-width: 4px;
    opacity: 0.8;
}
/* =========================================
   [NEW] 底部全宽横幅 (Footer Banner) - 黄黑白配色版
   ========================================= */
/* =========================================
   [NEW] 底部全宽横幅 (Footer Banner) - 黄黑白配色版 + 可点击
   ========================================= */
.p4-footer-banner {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 50;
    display: flex;
    flex-direction: column;
    box-shadow: 0 -10px 30px rgba(0,0,0,0.3); 
    transform-origin: bottom;
}

/* 1. 顶部滚动条 */
.footer-marquee-strip {
    background: var(--p4-yellow);
    color: var(--p4-black);
    padding: 12px 0;
    font-family: var(--font-tech);
    font-weight: 900;
    overflow: hidden;
    white-space: nowrap;
    border-top: 5px solid var(--p4-white);
    border-bottom: 5px solid var(--p4-black);
    position: relative;
    z-index: 2;
}

.footer-marquee-content {
    display: inline-block;
    animation: marquee 20s linear infinite; 
    font-size: 2rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    transform: skewX(-5deg); 
    font-weight: 900;
}

/* 2. 底部黑色大色块 */
.footer-solid-block {
    background: var(--p4-black);
    height: 220px;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    background-image: repeating-linear-gradient(
        45deg, 
        rgba(255,255,255,0.05) 0px, 
        rgba(255,255,255,0.05) 2px, 
        transparent 2px, 
        transparent 10px
    );
}

/* 3. CTA 文字：可点击状态 */
.footer-cta-text {
    font-family: var(--font-tech);
    font-size: clamp(2.5rem, 6vw, 4.5rem); 
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 4px;
    margin-bottom: 1rem;
    
    color: var(--p4-white);
    text-shadow: 5px 5px 0 var(--p4-yellow);
    transform: skewX(-15deg); 
    
    /* [修改点] 改为 pointer，表示可点击 */
    cursor: pointer; 
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.footer-cta-text:hover {
    transform: skewX(0deg) scale(1.05);
    color: var(--p4-yellow);
    text-shadow: 5px 5px 0 var(--p4-white);
}

/* 底部版权信息 */
.footer-copyright {
    font-family: var(--font-main);
    font-size: 0.8rem;
    color: #888;
    margin-top: 1.5rem;
    font-weight: bold;
    letter-spacing: 1px;
    opacity: 0.6;
}

/* =========================================
   [NEW] 子页面标题播放器交互样式
   ========================================= */
.section-big-title {
    cursor: pointer; /* 鼠标变手型 */
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    user-select: none; /* 防止快速点击时选中文本 */
}

/* Hover 效果：整体位移 + 变色 */
.section-big-title:hover {
    transform: translateX(15px) skewX(-5deg); /* P4 风格的倾斜位移 */
    text-shadow: 5px 5px 0 rgba(0,0,0,0.2);
    /* 强制使用当前页面的主题色 (由 JS 动态设置的变量) */
    color: var(--current-theme-color) !important; 
}

/* Hover 时三角形也变色放大 */
.section-big-title:hover::before {
    color: var(--current-theme-color);
    transform: scale(1.2);
}

/* [关键] 播放中状态：通过 JS 添加 .playing 类 */
.section-big-title.playing::before {
    content: '❚❚'; /* 将三角形 ▶ 变为暂停符号 ❚❚ */
    color: var(--current-theme-color);
    animation: p4-pulse 1s infinite alternate; /* 呼吸灯效果 */
}

/* 简单的呼吸动画 */
@keyframes p4-pulse {
    from { opacity: 1; transform: scale(1); }
    to { opacity: 0.6; transform: scale(1.1); }
}
/* =========================================
   [NEW] 首页导航栏 Brand Hover 效果
   ========================================= */
/* 确保 a 标签形式的 brand 没有默认下划线，且有过渡 */
a.nav-brand {
    text-decoration: none;
    display: inline-block;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
}

/* Hover 时：变色、倾斜、多重阴影 */
a.nav-brand:hover {
    color: var(--p4-black);
    text-shadow: 
        3px 3px 0 var(--p4-yellow),
        6px 6px 0 var(--p4-red);
    transform: skewY(0.5deg) skewX(-10deg) scale(1.1) translateX(10px);
}

/* =========================================
   [UPDATED] 子页面条形码波形动画 (慢速多样化版)
   ========================================= */

/* 定义一个更复杂的波形动画，增加关键帧数量以模拟多样性 */
@keyframes p4-waveform-complex {
    0%   { transform: scaleY(0.4) skewX(0deg); opacity: 0.6; }
    10%  { transform: scaleY(1.2) skewX(-2deg); opacity: 1; }
    20%  { transform: scaleY(0.7) skewX(1deg); opacity: 0.8; }
    35%  { transform: scaleY(1.5) skewX(-3deg); opacity: 0.9; }
    45%  { transform: scaleY(0.5) skewX(2deg); opacity: 0.7; }
    55%  { transform: scaleY(1.1) skewX(-1deg); opacity: 0.8; }
    70%  { transform: scaleY(1.4) skewX(3deg); opacity: 1; }
    80%  { transform: scaleY(0.6) skewX(-2deg); opacity: 0.7; }
    90%  { transform: scaleY(1.0) skewX(1deg); opacity: 0.9; }
    100% { transform: scaleY(0.4) skewX(0deg); opacity: 0.6; }
}

/* 当添加了 .playing 类时（音乐播放中）的样式 */
.barcode-deco.playing {
    /* 1. 改变纹理颜色：使用当前页面的主题色，线条变粗 */
    background: repeating-linear-gradient(90deg, var(--current-theme-color), var(--current-theme-color) 4px, transparent 4px, transparent 8px) !important;
    
    /* 2. 应用新的复杂动画 */
    /* [修改点] 时间改为 1.2s (变慢)，曲线改为 ease-in-out (更流畅) */
    animation: p4-waveform-complex 1.2s infinite ease-in-out !important;
    
    /* 3. 设置变换原点在底部，让条形向上跳动 */
    transform-origin: bottom;
    
    /* 4. 稍微增加高度以适应跳动，并调整位置 */
    height: 50px; 
    margin-top: -10px;
    opacity: 1; 
    
    /* [新增] 加上一点过渡效果，让开始和结束更平滑 */
    transition: all 0.5s ease;
}
/* =========================================
   [NEW] Art 页面灯箱 (Lightbox) 样式
   ========================================= */
.art-lightbox {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    z-index: 4000; /* 确保在最上层 */
    display: flex; justify-content: center; align-items: center;
    opacity: 0; pointer-events: none;
    transition: opacity 0.3s cubic-bezier(0.33, 1, 0.68, 1);
}

.art-lightbox.active {
    opacity: 1; pointer-events: auto;
}

/* 半透明黑色背景，带模糊 */
.lightbox-backdrop {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(8px);
    cursor: zoom-out; /* 提示点击可关闭 */
}

/* 放大后的图片样式 */
.art-lightbox img {
    /* [修改核心] 自动适配源文件比例与尺寸 */
    display: block;
    width: auto;  /* 宽度根据源文件自动调整 */
    height: auto; /* 高度根据源文件自动调整 */
    
    /* 限制最大尺寸：不超过屏幕宽高的 90%，防止溢出 */
    max-width: 65vw; 
    max-height: 65vh;
    
    /* [关键] 保持图片长宽比，防止被强制拉伸变形 */
    object-fit: contain; 
    
    /* P4 风格边框与特效 */
    border: 5px solid var(--p4-white);
    box-shadow: 0 0 50px var(--current-theme-color);
    
    /* 初始动画状态 */
    transform: scale(0.8) skewX(-2deg);
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    z-index: 4001;
    position: relative;
    pointer-events: auto; 
}

/* 激活状态下图片弹起 */
.art-lightbox.active img {
    transform: scale(1) skewX(0deg);
    opacity: 1;
    pointer-events: auto; /* 恢复图片交互 */
}

/* 关闭按钮 */
.lightbox-close {
    position: absolute; top: 40px; right: 40px;
    font-family: var(--font-tech); font-weight: bold; font-size: 1.5rem;
    color: var(--p4-white); background: var(--p4-black);
    border: 2px solid var(--p4-white); padding: 5px 20px;
    cursor: pointer; z-index: 4002;
    transform: skewX(-10deg);
    transition: all 0.2s ease;
}

.lightbox-close:hover {
    background: var(--p4-red);
    transform: skewX(-10deg) scale(1.1);
    box-shadow: 5px 5px 0 var(--p4-white);
}